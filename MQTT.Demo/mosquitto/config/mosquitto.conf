# Mosquitto Configuration for Persistent Sessions

# Listener
listener 1883
allow_anonymous true

# Enable persistent storage (REQUIRED for offline message queuing)
persistence true
persistence_location /mosquitto/data/

# Autosave interval (seconds) - how often to save in-memory data to disk
autosave_interval 300

# Maximum number of QoS 1 and 2 messages to hold in queue per client
# Default is 1000, increase if you expect long offline periods
max_queued_messages 10000

# Maximum QoS for clients (0, 1, or 2)
max_qos 2

# Session expiry - how long to keep session after disconnect
# Note: This is overridden by client's session expiry interval if provided
# Default is to never expire (0 means no expiry)
# You can set a global default here:
# persistent_client_expiration 1h

# Log settings (optional, useful for debugging)
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type all
log_timestamp true

# Connection settings
max_connections -1
max_keepalive 65535